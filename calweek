#!/usr/bin/python3

import argparse
import datetime
import shlex
import subprocess

from pytz import timezone

import cal
import timezones

def print_dashboard():
    """Prints the dashboard"""
    events = cal.process_calcurse(
        subprocess.check_output(shlex.split("calcurse -d 7")).decode())

    print("")
    cal.pretty_print_single_day(events, cal.is_today_from_n_days_partial(0), "Today", "yellow")
    cal.pretty_print_single_day(events, cal.is_today_from_n_days_partial(1), "Tomorrow", "cyan")
    cal.pretty_print_single_day(events, cal.is_today_from_n_days_partial(2), "After tomorrow", "green")
    cal.pretty_print_single_day(events, cal.is_today_from_n_days_partial(3), "D + 3", "dim")
    cal.pretty_print_single_day(events, cal.is_today_from_n_days_partial(4), "D + 4", "dim")
    cal.pretty_print_single_day(events, cal.is_today_from_n_days_partial(5), "D + 5", "dim")
    cal.pretty_print_single_day(events, cal.is_today_from_n_days_partial(6), "D + 6", "dim")
    cal.pretty_print_single_day(events, cal.is_today_from_n_days_partial(7), "D + 7", "dim")

if __name__ == "__main__":
    # TODO: Use the time zone
    parser = argparse.ArgumentParser()
    parser.add_argument("-f", dest="full", action="store_true",
                        help="Show full descriptions")
    parser.add_argument("timezone", nargs="?", default="UTC")
    args = parser.parse_args()

    print_dashboard()
